# errors

Drop in replacement for https://golang.org/pkg/errors/ and https://github.com/pkg/errors

# Обработка и доставка ошибок

## Какую проблему решаем?

- рассчитывать на наличие докера и связанного с ним подхода "без стейта"
- рассчитывать на отсутствие докера и возможность использования "стейта"

* наличие у каждой ошибки уникального буквенно-цифрового кода, на который можно ссылаться в документации.
* возможность оборачивать системные ошибки (нижнего уровня) в ошибки более высокого порядка. Без ограничении уровней.
* предоставить пользователю возможость погружения (drill-down) в иерархию ошибок.
* уметь какие то ошибки писать в журнал, какие то немедленно отправлять администратору, о каких то уведомлять пользователю без доп. действий на стороне сервера.

- иметь возможность изменять поведение при появлении ошибки. Например на этапе внедрения, все ошибки пишутся в журнал и немедленно приходит уведомление администратору.
- ошибку, захватывать в момент возникновения. Всегда передавать наверх, на каждом следующем уровне оборачивать ее и записывать в журнал в точке выхода.
- если из функции мы не выходим, но с ошибкой столкнулись, пишем ее в журнал немедленно и продолжаем работу функции.
- Возможность увидеть цепочку ошибок связанных с одним запросом клиента.
- сообщение об ошибке, должно быть максимально полезным для локализации проблемы, а так же автоматизированной обработки. Ошибка - это объект, следовательно в дополнительных атрибутах, должна быть информация упрощающая локализацию проблемы.
- Готовность к мультиязычности.
- Возможность работы с разными системами
- Прозрачную замену для пакета errors из стандартной библиотеки.

* sgfdgf
* f sdf
* sdfsdf

## Прицнипы регистрации и обработки ошибок

- контроллер->бизнес логика->репозитарий
- бизнес логика->репозитарий
- бизнес логика

## Прицнипы регистрации и обработки ошибок

```
    {
        "code" : "LMS-0012",
        "message" : "Ошибка создания профиля освещения",
        "severity" : "critical",
        "status_code": 500,
        "previous" :[
                        {
                            "code": "DBW-0001",
                            "message" : "insert failed"
                            "fields" : {"table" : "lighting_profiles", "sql": "insert into ....", "params":"1, 21, 2121"}
                            "severity" : "critical",
                            "status_code": 500
                        },
                        {
                            "message" : "unique contraint violation",
                            "fields" : {"constraint" : "lighting_profile_uk", "sql_code": 25111}
                            "severity" : "critical"
                       }
                    ]
    }
```
